"use strict";const e=require("../../../common/vendor.js"),a=require("../../../service/profile.js"),t=require("../../../store/profile.js"),n=require("../../../common/assets.js");require("../../../service/index.js");const o={__name:"user-info",setup(o){const r=t.useProfileStore(),i=e.ref(!1),u=e.ref(""),l=e.ref(""),s=e.ref("");async function v(){const t=await a.getUserInfo(),n=t.userInfo,o=t.rawData,v=t.signature,c=await a.getCode(),d=await a.getMytoken(c,l.value,u.value,o,v);console.log(d,"resm"),!0===d.success?(l.value=n.avatarUrl,u.value=n.nickName,s.value=d.data,r.setnickName(u.value),r.setavatarUrl(l.value),r.setopenid(s.value),e.index.setStorageSync("openid",s.value),e.index.setStorageSync("avatarUrl",l.value),e.index.setStorageSync("nickName",u.value),i.value=!0,e.index.showToast({title:"登录成功",duration:2e3})):e.index.showToast({title:"请再次登录",duration:2e3})}return l.value=n.touxiang,e.onMounted((()=>{s.value=e.index.getStorageSync("openid")||"",console.log(s.value,"openid"),s.value&&(u.value=e.index.getStorageSync("nickName"),l.value=e.index.getStorageSync("avatarUrl"),i.value=!0)})),(a,t)=>e.e({a:l.value,b:!i.value},i.value?{}:{c:e.o(v)},{d:i.value},i.value?{e:e.t(u.value)}:{},{f:e.o(((...e)=>a.itemClick&&a.itemClick(...e)))})}};wx.createComponent(o);
